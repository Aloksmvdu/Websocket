<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WSServer: frame.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WSServer
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('frame_8c.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">frame.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &quot;frame.h&quot;</code><br />
<code>#include &quot;str.h&quot;</code><br />
<code>#include &quot;header.h&quot;</code><br />
<code>#include &quot;alloc.h&quot;</code><br />
<code>#include &quot;log.h&quot;</code><br />
<code>#include &quot;predict.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for frame.c:</div>
<div class="dyncontent">
<div class="center"><img src="frame_8c__incl.png" border="0" usemap="#frame_8c" alt=""/></div>
</div>
</div>
<p><a href="frame_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5eb168cf9a6abf466f8e310df973bcbf"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a5eb168cf9a6abf466f8e310df973bcbf">random_bytes</a> (int length)</td></tr>
<tr class="separator:a5eb168cf9a6abf466f8e310df973bcbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0672b756ce5f51ad015ed1c31dec6efd"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a0672b756ce5f51ad015ed1c31dec6efd">ntohl64</a> (uint64_t value)</td></tr>
<tr class="separator:a0672b756ce5f51ad015ed1c31dec6efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a722212a492469c579952f9941438f6be"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a722212a492469c579952f9941438f6be">unmask</a> (frame_t *frame)</td></tr>
<tr class="separator:a722212a492469c579952f9941438f6be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad02cb45dbba180d7ce641c17fb57d835"><td class="memItemLeft" align="right" valign="top">frame_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#ad02cb45dbba180d7ce641c17fb57d835">WSS_parse_frame</a> (header_t *header, char *payload, size_t length, size_t *offset)</td></tr>
<tr class="separator:ad02cb45dbba180d7ce641c17fb57d835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85cde9b2c48d71b0c646a67e3b814934"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a85cde9b2c48d71b0c646a67e3b814934">WSS_stringify_frame</a> (frame_t *frame, char **message)</td></tr>
<tr class="separator:a85cde9b2c48d71b0c646a67e3b814934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa43a3b45ec3f4c75465beab7878fb869"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aa43a3b45ec3f4c75465beab7878fb869">WSS_stringify_frames</a> (frame_t **frames, size_t size, char **message)</td></tr>
<tr class="separator:aa43a3b45ec3f4c75465beab7878fb869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa190a0ec24d8885ee84c0dcdd575f74d"><td class="memItemLeft" align="right" valign="top">frame_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#aa190a0ec24d8885ee84c0dcdd575f74d">WSS_closing_frame</a> (header_t *header, wss_close_t reason)</td></tr>
<tr class="separator:aa190a0ec24d8885ee84c0dcdd575f74d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ef360cd7a4ca426a9717ef8a07e893"><td class="memItemLeft" align="right" valign="top">frame_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#af4ef360cd7a4ca426a9717ef8a07e893">WSS_ping_frame</a> (header_t *header)</td></tr>
<tr class="separator:af4ef360cd7a4ca426a9717ef8a07e893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70eb4405240e58b283f8a0a67c53b398"><td class="memItemLeft" align="right" valign="top">frame_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a70eb4405240e58b283f8a0a67c53b398">WSS_pong_frame</a> (header_t *header, frame_t *ping)</td></tr>
<tr class="separator:a70eb4405240e58b283f8a0a67c53b398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eca8e3abb13218fc17ae9e711af4d28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="frame_8c.html#a5eca8e3abb13218fc17ae9e711af4d28">WSS_free_frame</a> (frame_t *frame)</td></tr>
<tr class="separator:a5eca8e3abb13218fc17ae9e711af4d28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0672b756ce5f51ad015ed1c31dec6efd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0672b756ce5f51ad015ed1c31dec6efd">&#9670;&nbsp;</a></span>ntohl64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t ntohl64 </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts the unsigned 64 bit integer from host byte order to network byte order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>[uint64_t] "A 64 bit unsigned integer" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[uint64_t] "The 64 bit unsigned integer in network byte order" </dd></dl>
<p>If these check is true, the system is using the little endian convention. Else the system is using the big endian convention, which means that we do not have to represent our integers in another way.</p>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00065">65</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="a5eb168cf9a6abf466f8e310df973bcbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eb168cf9a6abf466f8e310df973bcbf">&#9670;&nbsp;</a></span>random_bytes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* random_bytes </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Converts the unsigned 64 bit integer from host byte order to network byte order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">length</td><td>[size_t] "The length of the random byte string" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[char *] "Random byte string of the given length" </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00045">45</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="a722212a492469c579952f9941438f6be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a722212a492469c579952f9941438f6be">&#9670;&nbsp;</a></span>unmask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void unmask </td>
          <td>(</td>
          <td class="paramtype">frame_t *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00083">83</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="aa190a0ec24d8885ee84c0dcdd575f74d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa190a0ec24d8885ee84c0dcdd575f74d">&#9670;&nbsp;</a></span>WSS_closing_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">frame_t* WSS_closing_frame </td>
          <td>(</td>
          <td class="paramtype">header_t *&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wss_close_t&#160;</td>
          <td class="paramname"><em>reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a closing frame given a reason for the closure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>[header_t *] "A HTTP header structure of the session" </td></tr>
    <tr><td class="paramname">reason</td><td>[wss_close_t] "The reason for the closure" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[frame_t *] "A websocket frame" </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00435">435</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="a5eca8e3abb13218fc17ae9e711af4d28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eca8e3abb13218fc17ae9e711af4d28">&#9670;&nbsp;</a></span>WSS_free_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WSS_free_frame </td>
          <td>(</td>
          <td class="paramtype">frame_t *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases memory used by a frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ping</td><td>[frame_t *] "The frame that should be freed" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[void] </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00579">579</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="ad02cb45dbba180d7ce641c17fb57d835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad02cb45dbba180d7ce641c17fb57d835">&#9670;&nbsp;</a></span>WSS_parse_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">frame_t* WSS_parse_frame </td>
          <td>(</td>
          <td class="paramtype">header_t *&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses a payload of data into a websocket frame. </p>
<p>Returns the frame and corrects the offset pointer in order for multiple frames to be processed from the same payload.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>[header_t *] "A HTTP header structure of the session" </td></tr>
    <tr><td class="paramname">payload</td><td>[char *] "The payload to be processed" </td></tr>
    <tr><td class="paramname">length</td><td>[size_t] "The length of the payload" </td></tr>
    <tr><td class="paramname">offset</td><td>[size_t *] "A pointer to an offset" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[frame_t *] "A websocket frame" </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00234">234</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="af4ef360cd7a4ca426a9717ef8a07e893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ef360cd7a4ca426a9717ef8a07e893">&#9670;&nbsp;</a></span>WSS_ping_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">frame_t* WSS_ping_frame </td>
          <td>(</td>
          <td class="paramtype">header_t *&#160;</td>
          <td class="paramname"><em>header</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a ping frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>[header_t *] "A HTTP header structure of the session" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[frame_t *] "A websocket frame" </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00524">524</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="a70eb4405240e58b283f8a0a67c53b398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70eb4405240e58b283f8a0a67c53b398">&#9670;&nbsp;</a></span>WSS_pong_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">frame_t* WSS_pong_frame </td>
          <td>(</td>
          <td class="paramtype">header_t *&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">frame_t *&#160;</td>
          <td class="paramname"><em>ping</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a pong frame from a received ping frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>[header_t *] "A HTTP header structure of the session" </td></tr>
    <tr><td class="paramname">ping</td><td>[frame_t *] "A ping frame" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[frame_t *] "A websocket frame" </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00558">558</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="a85cde9b2c48d71b0c646a67e3b814934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85cde9b2c48d71b0c646a67e3b814934">&#9670;&nbsp;</a></span>WSS_stringify_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t WSS_stringify_frame </td>
          <td>(</td>
          <td class="paramtype">frame_t *&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a single frame into a char array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frame</td><td>[frame_t *] "The frame" </td></tr>
    <tr><td class="paramname">message</td><td>[char **] "A pointer to a char array which should be filled with the frame data" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[size_t] "The size of the frame data" </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00313">313</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
<a id="aa43a3b45ec3f4c75465beab7878fb869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa43a3b45ec3f4c75465beab7878fb869">&#9670;&nbsp;</a></span>WSS_stringify_frames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t WSS_stringify_frames </td>
          <td>(</td>
          <td class="paramtype">frame_t **&#160;</td>
          <td class="paramname"><em>frames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts an array of frames into a char array that can be written to others. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frames</td><td>[frames_t **] "The frames to be converted" </td></tr>
    <tr><td class="paramname">size</td><td>[size_t] "The amount of frames" </td></tr>
    <tr><td class="paramname">message</td><td>[char **] "A pointer to a char array which should be filled with the frame data" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[size_t] "The size of the frame data" </dd></dl>

<p class="definition">Definition at line <a class="el" href="frame_8c_source.html#l00393">393</a> of file <a class="el" href="frame_8c_source.html">frame.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="frame_8c.html">frame.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
